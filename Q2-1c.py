import numpy as np
from sklearn.svm import SVC
from sklearn.metrics import confusion_matrix 
import timeit

with open("train.csv") as f1:
    x = np.genfromtxt(f1, delimiter=',')

#print(x.shape) #(22500, 785)
#print(x[:,-1])
y=x[:,-1]
X=x[:,:-1]
x1=X[(y==4,)]
x2=X[(y==5,)]
y1=y[(y==4)]
y2=y[(y==5)]
y=np.concatenate((y1, y2), axis=0)
X=np.concatenate((x1, x2), axis=0)
X=X/255.0
m=X.shape[0]
starttime = timeit.default_timer()
clf = SVC(kernel='linear')

#clf = SVC(kernel='linear', decision_function_shape='ovo')#0.836
#clf = SVC(kernel='rbf', gamma=0.05, C=1.0)
#clf = SVC(kernel='rbf', gamma=0.05 , C=1.0, decision_function_shape='ovo')
clf.fit(X,y)
print("training time:")
print(timeit.default_timer()-starttime)

with open("test.csv") as f1:
    x = np.genfromtxt(f1, delimiter=',')
y=x[:,-1]
X=x[:,:-1]
x1=X[(y==4,)]
x2=X[(y==5,)]
y1=y[(y==4)]
y2=y[(y==5)]
y=np.concatenate((y1, y2), axis=0)
X=np.concatenate((x1, x2), axis=0)
X=X/255.0

print('accuracy:')
print(clf.score(X,y)*100)
#print('confusion matrix:')
#print(confusion_matrix(y,clf.predict(X)))
print('b:')
print(clf.intercept_)
print('w:')
print(clf.coef_)
print('no of support vectors:')
print(clf.n_support_)

#w:
#[[ 0.00000000e+00  0.00000000e+00 -1.41540543e-04 -1.41540543e-04
#  -1.41540543e-04 -4.24621629e-04  0.00000000e+00 -1.67432049e-03
#  -2.82173269e-03 -1.56964668e-03  1.86500205e-02 -2.04172138e-02
#  -1.17411966e-01 -6.23188314e-02 -7.11321143e-02 -9.92925330e-02
#  -5.10205959e-02  4.04419881e-04 -2.33224017e-02  2.73078878e-02
#   2.88211198e-02  2.95384021e-02  1.30589956e-02  0.00000000e+00
#   4.80919790e-04  0.00000000e+00  0.00000000e+00  0.00000000e+00
#  -1.22029929e-03 -1.22029929e-03 -1.22029929e-03 -1.22029929e-03
#  -1.70841900e-03 -1.96371461e-03 -3.53859337e-03 -8.93542044e-03
#  -8.99877110e-03 -3.36975901e-02 -6.41820378e-02 -6.37319380e-02
#  -1.98414875e-01 -1.63327803e-01 -1.47964517e-01 -1.37456890e-01
#  -6.05584244e-03 -1.91213316e-02  2.04013470e-02  2.36864825e-02
#   5.94311640e-02  8.77202211e-02  5.75771280e-02  1.08479547e-02
#  -2.08811456e-03 -3.41187343e-03 -3.39432404e-03 -3.66089787e-03
#  -1.22029929e-03 -1.22029929e-03 -1.22029929e-03 -1.27984768e-03
#  -1.70841900e-03 -3.08701526e-03 -1.91510182e-02 -3.26053462e-02
#  -6.84303195e-02 -9.63991937e-02 -4.29774872e-02  4.35002631e-03
#  -6.76241214e-02 -2.05853783e-01 -2.43746283e-01 -9.09263886e-02
#   3.77969100e-02 -2.08757649e-02 -7.74070061e-03 -3.07604482e-02
#   1.68971829e-02  6.57087978e-02  6.85299837e-02  5.50286711e-02
#   2.92848634e-02  1.00217602e-02 -1.48195655e-03 -3.41683801e-03
#  -1.22029929e-03 -1.22029929e-03 -1.64492092e-03 -2.30424902e-03
#  -3.90396119e-03 -2.77158613e-02 -6.05116101e-02 -6.72322717e-02
#  -1.01560920e-01 -6.33152425e-02 -1.36579933e-02 -4.02156572e-02
#   1.06402742e-03 -1.31648558e-01 -2.41268215e-01 -1.27412604e-02
#   1.11178752e-02  3.86324560e-03 -2.11885270e-02 -1.90199387e-02
#  -2.45739801e-02  6.90259602e-02  6.73315543e-02  8.38987380e-02
#   5.09938589e-02  2.28066375e-02 -2.35774194e-03 -2.44718343e-03
#  -1.22029929e-03 -1.22029929e-03 -1.42156128e-03 -3.96108198e-03
#  -1.27162152e-02 -4.38975528e-02 -5.18905453e-02 -6.57413719e-02
#  -8.53550325e-02 -8.57591652e-02 -5.44000453e-02 -4.22791986e-02
#  -2.89247409e-02 -5.42568034e-02 -5.00969704e-02 -1.47289231e-02
#  -2.60127224e-02 -1.06525646e-02 -1.10273578e-02  3.54349664e-04
#  -8.43349464e-03  5.77551508e-02  3.83725278e-02  4.64584159e-02
#   3.84483936e-02  6.13637040e-03 -1.29016864e-03 -2.89973460e-03
#  -1.22029929e-03 -1.22029929e-03 -1.25932052e-03 -7.34739377e-03
#  -2.59060680e-02 -5.37926322e-02 -5.93022265e-02 -5.75602216e-02
#  -1.07630494e-01 -1.56431871e-01 -1.18276189e-01 -3.90079865e-02
#  -1.46288447e-02 -4.59801868e-02 -3.34061026e-02 -4.69794981e-02
#  -4.67994497e-02 -4.92006611e-02  3.08256482e-02  3.14699779e-02
#   1.05702651e-02  9.54330549e-02  7.52076234e-02  9.87852399e-03
#   8.79751111e-03  6.98218290e-03  3.55695540e-03 -3.05548584e-03
#  -1.22029929e-03 -1.22029929e-03 -2.03724522e-03 -7.80692586e-03
#  -3.63379952e-02 -5.07254051e-02 -1.00719372e-01 -1.18972503e-01
#  -1.49915973e-01 -1.34942313e-01 -1.32884907e-01 -1.18648305e-01
#  -7.68146632e-03 -1.46421160e-01 -1.07797077e-01 -1.18242566e-04
#   5.01566249e-02  3.36607491e-02 -1.16248273e-03 -7.85768284e-02
#  -1.75305346e-02  4.68761875e-02  7.16008157e-02  1.66620119e-02
#   1.17231142e-02  3.48029201e-03  1.46499168e-03 -1.06962796e-03
#  -1.95288399e-03 -9.76239431e-04 -2.19042258e-03 -6.51309595e-03
#  -3.11843934e-02 -1.05446880e-01 -1.37907371e-01 -1.58203421e-01
#  -1.48124046e-01 -9.69435707e-02 -1.40496368e-01 -9.86815457e-02
#  -8.85954696e-02 -2.29169924e-02 -1.90738522e-02  6.40963549e-03
#  -2.12176867e-02  1.21441958e-02 -1.85073450e-02 -4.89604823e-02
#  -3.39614847e-02  1.15014942e-02  8.09240544e-03  3.78532215e-02
#   3.82872279e-02  2.82087109e-02  1.51275144e-02  7.91974649e-03
#  -8.58622091e-04 -7.81078205e-04 -1.07835767e-03 -2.91351152e-03
#  -4.47302799e-02 -1.32101093e-01 -1.22614361e-01 -1.63193027e-01
#  -1.73352739e-01 -1.09487447e-01 -1.14440441e-01 -2.95710277e-02
#  -4.75852495e-02 -2.42192746e-02  3.37416079e-03 -5.25430389e-02
#   2.51612440e-03  1.76431265e-02  1.60274022e-02 -6.25672679e-03
#  -5.41566457e-02  6.13037405e-02  2.33367082e-02  4.77292555e-02
#   3.14126746e-02  4.33488184e-02  8.38441933e-03  2.93802627e-04
#  -6.14562233e-04 -4.88119716e-04 -6.75842751e-04 -8.05033179e-03
#  -8.25204091e-02 -1.31612882e-01 -1.25485801e-01 -1.41209567e-01
#  -1.47448942e-01 -1.08250541e-01 -5.62379599e-02 -2.67122906e-03
#  -4.84553023e-03 -9.10007410e-02  1.59077937e-02  4.66196660e-02
#   1.00597849e-01  9.40120714e-02  7.70790529e-02 -1.44064237e-02
#  -3.02762687e-02 -4.56247029e-03 -3.00919274e-03  4.08385694e-02
#   4.20636544e-02  3.83815449e-02  3.60038480e-02  1.80703908e-02
#  -4.88119716e-04 -2.14845035e-03 -3.13689453e-03 -1.66993842e-02
#  -8.91780202e-02 -9.12746184e-02 -1.16394295e-01 -8.79739469e-02
#  -1.24523012e-01 -5.33218381e-02 -8.09586898e-02  3.64533659e-02
#   8.57829398e-03 -8.55714901e-02 -9.83625874e-02 -5.84897845e-02
#   4.36539103e-02  3.88130332e-02  5.07211217e-02 -4.89373121e-02
#   9.32862141e-03  3.49515323e-02 -1.22502603e-02  1.45350381e-02
#   9.66779445e-02  7.16920540e-02  6.45847298e-02  3.15677967e-02
#  -2.42002375e-04 -4.24628979e-04 -4.79798289e-03 -4.80915375e-02
#  -8.75254876e-02 -8.44501448e-02 -8.90928547e-02 -6.16409844e-02
#  -7.42198912e-02  1.43497710e-02  3.32075287e-02  6.71834525e-02
#   5.54167806e-02 -1.07777694e-02 -2.45883427e-02 -6.26325683e-02
#   1.71141393e-02  1.56781099e-02  2.41344643e-02 -2.17692948e-02
#   1.69942956e-02  4.92949060e-02 -7.40503548e-03  3.77350615e-02
#   7.14200538e-02  9.56204544e-02  9.06115266e-02  3.98900650e-02
#  -1.92192015e-04  9.17941166e-04  1.81711877e-02 -5.55356297e-02
#  -7.67041167e-02 -4.85193709e-02 -2.92579865e-03  3.73416655e-02
#  -2.91862573e-02  5.06800565e-02  6.86022609e-02  5.86443806e-02
#   4.09333669e-02  7.94754912e-02  8.86500701e-03 -1.89888157e-02
#   4.38175091e-02  7.54787669e-02  8.73668649e-02  1.62769471e-02
#   2.09204379e-02  3.74776400e-02 -3.08681866e-03  4.07758039e-02
#   2.04099318e-02  8.20712361e-02  7.69531804e-02  1.61954138e-02
#   1.11838963e-02  1.71179324e-02 -1.46092425e-03 -3.92079579e-02
#   2.79079064e-03  3.62202253e-02 -2.87405183e-02  4.20545137e-02
#  -2.28715762e-02  3.20942634e-02  8.96049061e-02  3.57909371e-02
#   2.66238584e-02 -1.79092475e-02  5.50213502e-02  3.16148969e-02
#   3.70185861e-02  1.44399321e-01  8.59737836e-02 -9.35941634e-03
#   3.28692274e-02 -1.34506308e-02  1.99859137e-02  1.62057557e-02
#  -1.92071769e-02  2.47366961e-02  6.72932972e-02  1.49092429e-02
#   3.12468524e-02  5.15165264e-02  1.41694686e-03 -2.98953280e-02
#   6.13165079e-02  2.07205686e-02 -1.81748892e-02  1.80520115e-02
#  -4.39196269e-02 -1.37660549e-01 -1.19161881e-01 -1.09011098e-01
#  -5.08285620e-02  2.26350135e-02  1.31974765e-02 -3.87154788e-02
#  -4.40386487e-02  3.24945693e-02 -1.35483114e-01 -1.82434787e-02
#   2.45489796e-02  2.91400672e-03  4.81157578e-02  2.85307935e-02
#   4.85592508e-02  3.35401092e-02  1.14745788e-01  3.02530301e-02
#   5.19195240e-02  4.48470984e-02 -2.86718636e-03 -1.28045888e-02
#   3.56024531e-02  8.83841493e-02 -5.07652283e-02  5.43933522e-03
#  -9.89643408e-03 -2.46861377e-02 -1.31950679e-02 -6.76432228e-02
#  -6.89536194e-02 -6.64939417e-02 -4.87840710e-02  4.13016357e-02
#  -3.39765301e-02  5.96941345e-02  5.21485141e-02  9.34618544e-02
#   6.65551509e-02  3.02394424e-02  5.51941084e-02  2.60457545e-02
#   8.39718214e-02  3.43627426e-02  1.08204177e-01  5.45929394e-02
#   2.44948087e-02  2.82855321e-02  2.05607003e-02  9.11885493e-03
#   4.15068048e-02  6.72828109e-02 -3.62180257e-02 -5.35645680e-02
#   5.61428227e-03  3.14382969e-02  2.84803657e-02  2.92760918e-02
#   3.75290415e-02  3.95302953e-02  8.11050633e-03 -4.06430895e-02
#   4.12970288e-02  8.13420684e-02  3.41163542e-02  4.31040250e-02
#   2.27434770e-03  1.66770259e-02  6.22084802e-02  2.63237452e-02
#   8.51202108e-02  4.91179872e-02  8.30481016e-02  5.11359366e-02
#   1.74511889e-03 -1.02550722e-02 -2.54655794e-02 -3.02150995e-02
#   1.88422029e-02  2.61612247e-02 -2.81460248e-02 -9.29297634e-02
#  -1.86568425e-02 -5.62265376e-03  2.82456217e-02  1.54379558e-02
#  -8.10639130e-05  9.88102201e-02  5.36130447e-02 -4.45339755e-02
#   4.01467051e-02  5.89985468e-02  8.97422105e-02  7.48112102e-02
#   4.93952072e-02 -4.61809433e-02  5.13721784e-02  2.78167619e-02
#   5.33082872e-02  4.95032810e-02  4.00216570e-02  8.42874328e-03
#   4.51857773e-02  8.37603378e-02  4.42791187e-02 -1.38975023e-02
#  -1.15808624e-02 -4.89740346e-03 -1.35590834e-02 -3.22384155e-02
#  -4.48210808e-02 -4.03994456e-02  1.20506130e-02  2.62782604e-02
#  -7.91793765e-03 -8.19970736e-04  2.49715004e-03  9.04826369e-03
#   7.02222205e-02  9.56520162e-02  3.13009696e-02  8.72283021e-02
#   7.77591085e-02 -3.33594398e-02  2.60575199e-02  3.88074795e-02
#   2.27695449e-02  5.88221185e-02  7.12201532e-02  4.11093674e-02
#   2.14250619e-02  3.75901395e-02  3.34800517e-02  3.20105186e-02
#  -2.11214256e-02 -5.94591275e-02 -2.19454401e-02 -3.03368159e-02
#  -2.13221282e-02 -5.16341890e-03 -6.63149713e-03  3.26249935e-02
#   5.54939358e-03  5.22255955e-03 -5.50912950e-02 -7.41444896e-02
#  -3.83246617e-02  5.47550973e-02  7.55538406e-02 -2.22858449e-02
#   1.80895295e-02 -6.21912338e-02 -2.96689169e-02  2.07227893e-02
#   4.38644541e-02  8.19006891e-02  6.24926455e-02  1.65207585e-02
#   3.73024602e-03  4.07059484e-02  2.06653473e-02  1.66581644e-02
#   2.30653663e-03 -1.66563178e-02  1.67789323e-02  2.26410346e-02
#  -7.95796829e-02 -7.12307997e-02  1.44236449e-02  1.74197893e-02
#  -6.66366965e-02  6.78847298e-03  2.44704920e-02 -6.60221707e-02
#  -5.53025295e-02  5.43046003e-02  2.42757916e-02 -7.05180459e-02
#   4.44094402e-02 -1.64237811e-03  2.64143413e-02  7.87196431e-02
#   4.68775669e-02  6.02975834e-02  2.75180321e-02 -7.08005350e-03
#   1.22853437e-02  4.23645579e-02 -5.09724127e-04 -7.56730958e-03
#  -4.90805201e-02 -7.53639076e-03  3.19031523e-02  4.04216399e-03
#  -1.02435244e-01 -7.71439780e-02  1.54726253e-03  2.75818534e-02
#  -2.87350725e-02 -6.95161972e-02 -7.34847266e-02 -7.06884759e-02
#   5.06698896e-03  1.74416319e-02 -4.86376889e-02 -8.84618998e-02
#  -7.12431832e-03 -1.82781284e-03  4.66457170e-02  3.14177648e-02
#   3.05460477e-02  4.37153693e-02  2.14843517e-02 -1.77813032e-03
#   2.19913626e-02  6.93772522e-02  4.02430882e-02  1.32834300e-02
#  -1.57392114e-03 -6.01271889e-03 -1.96331674e-02  1.32531478e-02
#  -2.06623341e-02 -3.59255562e-03 -1.24206450e-02 -5.57197441e-02
#  -6.40562050e-02  1.45722981e-02 -9.23002443e-02 -2.64902761e-02
#   4.24206343e-02 -7.35564877e-02 -9.11710181e-02 -1.07471923e-01
#  -3.00472310e-02  4.79516739e-03  7.86722919e-03  5.17476422e-02
#   3.27456006e-02  6.83806926e-02  3.30698141e-02  1.31276520e-02
#   1.37841589e-02  2.14427939e-02  3.25753764e-03  9.37090323e-03
#   1.89241755e-03 -5.82544375e-03 -1.23627005e-02  6.85238623e-02
#   6.68912246e-02 -2.76795331e-03  5.18300266e-02 -2.12402198e-02
#  -5.61865829e-02  2.64111781e-02  1.53111175e-02  1.45564460e-02
#  -3.48684464e-02 -1.33261602e-01 -9.16561361e-02 -4.37891928e-02
#  -4.40187140e-03 -2.73502353e-03 -2.10216237e-02  3.33239580e-02
#   1.85417216e-02  4.95712576e-02  1.61575699e-02  6.13464714e-03
#   9.91908234e-03  2.71503703e-02  7.13157323e-03 -1.31621325e-02
#  -2.26199423e-02 -4.20820350e-02 -4.99036609e-02  4.58733214e-02
#   5.02553993e-02 -8.94559148e-03  1.51296617e-02  5.11288157e-03
#  -2.04847152e-02 -2.14259683e-02  2.38935628e-02  5.40122880e-02
#  -6.55049583e-02 -7.46170727e-02 -4.51987805e-02 -3.65073143e-02
#  -3.31283002e-02 -2.63125869e-02 -6.07441890e-02  4.81454943e-03
#   9.42506541e-03  2.98417575e-02  5.72542533e-03 -6.04846180e-05
#   1.61984652e-03  5.25963698e-03  7.36068564e-03 -6.97629134e-03
#   1.19169148e-02  4.95954051e-02  3.51805335e-02  3.93401770e-02
#   5.05480585e-02 -2.55512075e-02 -5.05532175e-02  3.74984082e-03
#   1.49065746e-02  7.97209469e-03  7.80785537e-02 -1.14462743e-02
#  -5.71366381e-02 -5.81378133e-02 -3.59939513e-02 -3.32741665e-02
#  -5.42928741e-02 -3.98546903e-02 -3.91028461e-02  5.82694375e-03
#   3.07521521e-04  1.22984025e-02 -1.18801581e-02 -2.66788637e-03
#  -9.06027133e-04  6.80348590e-04  9.52456034e-03 -5.70563747e-03
#  -1.79709669e-02 -5.32440113e-03  3.07110435e-02  5.82497293e-02
#   6.81956828e-02 -4.36182028e-03 -2.40179018e-02  2.14483325e-03
#   6.56602945e-03 -2.53500085e-03 -1.15947495e-02 -6.28214736e-02
#  -9.68125259e-02 -8.28470190e-02 -5.16398181e-02 -5.45238012e-02
#  -3.04394741e-03 -7.54467051e-03 -2.63471014e-02  3.80053824e-02
#  -2.69803499e-02 -2.36632572e-02 -2.31294700e-02 -2.68465844e-03
#  -1.22029929e-03 -1.70841900e-03 -2.08830434e-03  1.26292935e-03
#  -8.40175738e-03 -3.86566479e-02 -1.09462341e-02  4.87017267e-02
#   4.61851839e-02  3.25967327e-02  3.03437144e-02  3.07439889e-02
#  -1.46373566e-02 -1.00796558e-02 -1.05808389e-02 -3.65245228e-02
#  -4.00117609e-02 -4.22712266e-02 -1.92720971e-02 -1.66117120e-04
#   1.25072755e-02  8.34483199e-03 -3.60435239e-02 -8.87302168e-03
#  -2.88278339e-02 -1.39227339e-02 -3.99754455e-03 -3.17277815e-03]]